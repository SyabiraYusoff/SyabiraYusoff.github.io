<nav class="breadcrumb">
    <button onclick="loadHome()"><i class="fa fa-fw fa-home"></i> Home</button>
    <span>&rsaquo;</span>
    <button onclick="loadStep('step1')"> Pipeline Setup</button>
    <span>&rsaquo;</span>
    <button onclick="loadSection('step1_Docker_Based(MacOS)')" style="color:darkgrey">MacOS Installation</button>
</nav>
<div id="topPage"></div>
<div class="fab-container">
    <div class="button iconbutton" onclick="loadStep('feedback')">
        <span>Share your feedback</span>
    </div>
</div>
<h2>Local Installation on MacOS</h2>

<div class="notice tree">
    <ul>
        <li>The docker image features require root-level access to install.</li>
        <li>For users operating on an institutional server,  please collaborate with your system administrator to determine the directories, system resources allocation for Docker image.</li>
        <li>For those who do not have root access, you can skip the docker installation process and use <button onclick="loadSection('step1_Pipeline_Bundle')">Docker-free" bundle</button>. </li>
    </ul>
</div> 
<div class="card">
    <h2>Software requirements for local installation</h2>
    <ol>
        <li><b>Docker container</b>: </li>
        <ul>
            <li>A Docker container is a self-contained environment for pipeline analysis and is obtained by "pulling" or downloading a Docker image to your local computer.</li>
            <li>It encompasses all the necessary libraries and settings required by the pipeline to execute the analysis.</li></ul><br>
                        <li><b>CWL-runner</b>:</li>
                        <ul>
                            <li>The CWL-runner is the tool responsible for managing Docker containers to complete the pipeline run.</li>
                            <li>It utilizes two inputs:</li>
                            <li>"CWL workflow" file: This file describes each step in the pipeline and outlines how each Docker container should run to complete the step.</li>
                            <li>"YML input specification" file: This file informs the CWL-runner about the location of the pipeline inputs to execute the tools during pipeline analysis. </li>
                            <li>Once the pipeline run is completed, the CWL-runner retrieves the final outputs from the Docker containers and adds them to a designated output folder on your computer.</li></ul></ol></div>
                            
                            <div class="card" style="background-color: #f1f1f1;">
                                <h2>Docker installation</h2>
                            
                            <ol>
                            <li>Install <a href="https://docs.docker.com/get-docker/">Community edition Docker</a> depending on your system (MacOS). </li>
                            <li>Ensure that you successfully complete the installation process and agree to the terms and conditions; failure to do so will prevent Docker from running.</li>
                            <li >Open your terminal and validate that Docker is running properly by typing the command below:<br>
                            <p class="code">docker</p>
                            <li>Verify that the Docker manual is printed to the terminal screen.</li>
                            <li>Proceed with the next installation steps. </li></ol></div>
                            
                            <div class="card">
                            <h2>Python Installation Using Homebrew:</h2>
                            <p class="notice">This installation guide is tailored for the latest version of macOS M3 Apple Silicon chip. Unlike UNIX/Linux-based systems, macOS lacks a standard operation for installing third-party command-line tools beyond the standard Apple installer. To address this, we will leverage Homebrew to facilitate the installation and management of command-line utilities.</p>
                            <ol>
                            <li>Open terminal </li>
                            <li>paste the following command </li>
                            <p class="code">/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</p>
                            <li>Press Return key</li>
                            <li>You will be presented with a list of items to be installed, enter your admin password when prompted. </li>
                            <li>Continue entering your password until you receive the notification of "installation successful". </li>
                            <li>Type code below to make sure it is on your PATH; otherwise an error "brew command not found" will be displayed. </li>
                            <p class="code">brew</p>
                            <li>Then we need to install Python. For Python version greater than 3.4, pip, a package manager for Pyhton will be installed simultaneously. Pip allow users to install and manage packages that are not part of the Pyhton standard library. </li>
                            <li>To install Python, type the command below and press Return key. </li>
                            <p class="code">brew install python</p>
                            <li>Now link the Homebrew Python version and set it as the default. Enter the command below and press Return key.</li>
                            <p class="code">brew unlink python && brew link python</p>
                            <li>Check if a version of Python 3 is already installed by running the following command and press Return key.</li>
                            <p class="code">python3 --version</p>
                            <li>Ensure that you are using a local installation of Python and not a system version by running following command.</li>
                            <p class="code">which python3</p>
                            <li>This should return the path to a local installation, such as (/usr/bin/python for macOS intel) or (/opt/homebrew/bin/pyhton3 for Mac M1/M2/M3), and not to a system path (e.g., /c/mnt/Python/bin/python). Using a system installation of python may not grant sufficient permissions for installing required packages.</li>
                            <li>Install/update pip in terminal by entering command line below.</li>
                            <p class="code">python3 -m pip install -upgrade pip</p>
                            <p>Please continue to CWL runner installation for MasOS and LINUX systems.</p>
                            </ol></div>

                            <div class="card" style="background-color: #f1f1f1;">
                            <h2>CWL-runner installation</h2>
                            <ol>
                            <li>Update pip before installing cwl-runner by using the command:</li>
                            <p class="code">pip install -U pip</p>
                            <li>Install the package from PyPi. Enter:</li>
                            <p class="code">pip install cwl-runner</p>
                            <li>Ensure that cwl-runner is in your path. Type:</li>
                            <p class="code">cwl-runner</p>
                            <li>If the command is not found, add the install location of the pip packages to $PATH. Find where cwl-runner is installed by entering:</li>
                            <p class="code">pip show cwl-runner</p>
                            <li>Add the above location to $PATH. For example:</li>
                            <p class="code">export</p>
                            <p>PATH=$PATH:<mark>`/Library/Frameworks/Python.framework/Versions/3.6/lib/python3`</mark></p>
                            <p>You should substitute the <mark>`highlighhted`</mark> part after : with your <mark>`Location`</mark></p>
                            <li>Restart the command line utility.</li></ol></div>
                            <div class="card">
                            <h2>Configure CWL and YML files:</h2>
                            <ol>
                            <li>Ensure that you are employing the correct CWL files for your pipeline; otherwise, the analysis may encounter failures.</li>
                            <li>If necessary, establish a Bitbucket account by visiting bitbucket.org/CRSwDev/cwl.</li>
                            <li>Navigate to the left pane and select Downloads > Download Repository. This action will result the downloading of CWL and YML files crucial for the analysis.</li>
                            <li>Unzip the archive, and within it, you will find folders named after the respective pipeline versions they corresponds to.</li></ol>
                            
                            <h2>Configure pipeline image:</h2>
                            <ol>
                            <li>Confirm that Docker is operational. Navigate to the download directory where you saved the Docker application and double click on it to ensure it is running.</li>
                            <li>Download (pull) the latest Docker image by executing the following command:</li>
                            <p class="code">docker pull bdgenomics/rhapsody</p>
                            <li>Verify the availability of the pipeline image by entering:</li>
                            <p class="code">docker images</p>
                            <li>The pull command automatically fetches the latest version of the pipeline. If you wish to download an earlier version, specify the version number in the following manner:</li>
                            <p class="code">docker pull bdgenomics/rhapsody:v1.0</p></ol></div>
            </div>
            <div class="scroll-top">
                <button><a href="#topPage">Scroll to top page</a></button>
            </div>